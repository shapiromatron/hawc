import pytest

from hawc.apps.common.dsstox import fetch_dsstox


@pytest.mark.vcr
def test_dsstox():
    # bad casrn failure
    response = fetch_dsstox("abc-123")
    assert response == {}

    # test success
    response = fetch_dsstox("1836-75-5")
    assert response == {
        "CASRN": "1836-75-5",
        "CommonName": "Nitrofen",
        "SMILES": "[O-][N+](=O)C1=CC=C(OC2=C(Cl)C=C(Cl)C=C2)C=C1",
        "MW": 284.09,
        "DTXSID": "DTXSID7020970",
        "image": "/9j/4AAQSkZJRgABAgEAIwAjAAD//ggzPD94bWwgdmVyc2lvbj0nMS4wJyBlbmNvZGluZz0nVVRGLTgnPz48Y21sIHhtbG5zPSJodHRwOi8vd3d3LmNoZW1heG9uLmNvbSIgeG1sbnM6eHNpPSJodHRwOi8vd3d3LnczLm9yZy8yMDAxL1hNTFNjaGVtYS1pbnN0YW5jZSIgeHNpOnNjaGVtYUxvY2F0aW9uPSJodHRwOi8vd3d3LmNoZW1heG9uLmNvbS9tYXJ2aW4vc2NoZW1hL21ydlNjaGVtYV8xNl8wMl8xNS54c2QiIHZlcnNpb249IkNoZW1BeG9uIGZpbGUgZm9ybWF0IHYxNi4wMi4xNSwgZ2VuZXJhdGVkIGJ5IHYxNi4yLjI5LjAiPgo8TURvY3VtZW50PjxNQ2hlbWljYWxTdHJ1Y3Q+PG1vbGVjdWxlIG1vbElEPSJtMSI+PGF0b21BcnJheSBhdG9tSUQ9ImExIGEyIGEzIGE0IGE1IGE2IGE3IGE4IGE5IGExMCBhMTEgYTEyIGExMyBhMTQgYTE1IGExNiBhMTcgYTE4IiBlbGVtZW50VHlwZT0iQ2wgQyBDIEMgQyBDIEMgQ2wgTyBDIEMgQyBDIEMgQyBOIE8gTyIgZm9ybWFsQ2hhcmdlPSIwIDAgMCAwIDAgMCAwIDAgMCAwIDAgMCAwIDAgMCAxIDAgLTEiIHgyPSIyLjY2ODE3MTg5NzE4NzI0NDYgMi42NjgxNzE4OTcxODcyNDQ2IDQuMDAyMzE1ODM2OTEwOTk1IDQuMDAyMzE1ODM2OTEwOTk1IDIuNjY4MTcxODk3MTg3MjQ0NiAxLjMzNDE0MzkzOTcyMzc1MDIgMS4zMzQxNDM5Mzk3MjM3NTAyIDAuMCA1LjMzNjQ1OTc3NjYzNDc0NSA2LjY4MjU0OTg4OTE2NDg1NDUgOC4wMTY2OTM4Mjg4ODg2MDQgOS4zNTA3MjE3ODYzNTIxIDkuMzUwNzIxNzg2MzUyMSA4LjAxNjY5MzgyODg4ODYwNCA2LjY4MjU0OTg4OTE2NDg1NDUgMTAuNjg0ODY1NzI2MDc1ODQ5IDEwLjY4NDg2NTcyNjA3NTg0OSAxMi4wMTg4OTM2ODM1MzkzNDMiIHkyPSIwLjAgLTEuNTM4Mzg4NzAwMDM0NDEwMyAtMi4zMDc1ODMwNTAwNTE2MTU1IC0zLjg1ODAzMzkwNTE1MjY0MDcgLTQuNjI3MzQ0MjM3NDMwMTAyIC0zLjg1ODAzMzkwNTE1MjY0MDcgLTIuMzA3NTgzMDUwMDUxNjE1NSAtNC42MjczNDQyMzc0MzAxMDIgLTEuNTM4Mzg4NzAwMDM0NDEwMyAtMi4zMDc1ODMwNTAwNTE2MTU1IC0xLjUzODM4ODcwMDAzNDQxMDMgLTIuMzA3NTgzMDUwMDUxNjE1NSAtMy44NTgwMzM5MDUxNTI2NDA3IC00LjYyNzM0NDIzNzQzMDEwMiAtMy44NTgwMzM5MDUxNTI2NDA3IC00LjYyNzM0NDIzNzQzMDEwMiAtNi4xNjU3MzI5Mzc0NjQ1MTIgLTMuODU4MDMzOTA1MTUyNjQwNyIvPjxib25kQXJyYXk+PGJvbmQgaWQ9ImIxIiBhdG9tUmVmczI9ImExIGEyIiBvcmRlcj0iMSIvPjxib25kIGlkPSJiMiIgYXRvbVJlZnMyPSJhMiBhMyIgb3JkZXI9IjIiLz48Ym9uZCBpZD0iYjMiIGF0b21SZWZzMj0iYTIgYTciIG9yZGVyPSIxIi8+PGJvbmQgaWQ9ImI0IiBhdG9tUmVmczI9ImEzIGE0IiBvcmRlcj0iMSIvPjxib25kIGlkPSJiNSIgYXRvbVJlZnMyPSJhMyBhOSIgb3JkZXI9IjEiLz48Ym9uZCBpZD0iYjYiIGF0b21SZWZzMj0iYTQgYTUiIG9yZGVyPSIyIi8+PGJvbmQgaWQ9ImI3IiBhdG9tUmVmczI9ImE1IGE2IiBvcmRlcj0iMSIvPjxib25kIGlkPSJiOCIgYXRvbVJlZnMyPSJhNiBhNyIgb3JkZXI9IjIiLz48Ym9uZCBpZD0iYjkiIGF0b21SZWZzMj0iYTYgYTgiIG9yZGVyPSIxIi8+PGJvbmQgaWQ9ImIxMCIgYXRvbVJlZnMyPSJhOSBhMTAiIG9yZGVyPSIxIi8+PGJvbmQgaWQ9ImIxMSIgYXRvbVJlZnMyPSJhMTAgYTExIiBvcmRlcj0iMiIvPjxib25kIGlkPSJiMTIiIGF0b21SZWZzMj0iYTEwIGExNSIgb3JkZXI9IjEiLz48Ym9uZCBpZD0iYjEzIiBhdG9tUmVmczI9ImExMSBhMTIiIG9yZGVyPSIxIi8+PGJvbmQgaWQ9ImIxNCIgYXRvbVJlZnMyPSJhMTIgYTEzIiBvcmRlcj0iMiIvPjxib25kIGlkPSJiMTUiIGF0b21SZWZzMj0iYTEzIGExNCIgb3JkZXI9IjEiLz48Ym9uZCBpZD0iYjE2IiBhdG9tUmVmczI9ImExMyBhMTYiIG9yZGVyPSIxIi8+PGJvbmQgaWQ9ImIxNyIgYXRvbVJlZnMyPSJhMTQgYTE1IiBvcmRlcj0iMiIvPjxib25kIGlkPSJiMTgiIGF0b21SZWZzMj0iYTE2IGExNyIgb3JkZXI9IjIiLz48Ym9uZCBpZD0iYjE5IiBhdG9tUmVmczI9ImExNiBhMTgiIG9yZGVyPSIxIi8+PC9ib25kQXJyYXk+PC9tb2xlY3VsZT48L01DaGVtaWNhbFN0cnVjdD48L01Eb2N1bWVudD4KPC9jbWw+//4IMzw/eG1sIHZlcnNpb249JzEuMCcgZW5jb2Rpbmc9J1VURi04Jz8+PGNtbCB4bWxucz0iaHR0cDovL3d3dy5jaGVtYXhvbi5jb20iIHhtbG5zOnhzaT0iaHR0cDovL3d3dy53My5vcmcvMjAwMS9YTUxTY2hlbWEtaW5zdGFuY2UiIHhzaTpzY2hlbWFMb2NhdGlvbj0iaHR0cDovL3d3dy5jaGVtYXhvbi5jb20vbWFydmluL3NjaGVtYS9tcnZTY2hlbWFfMTZfMDJfMTUueHNkIiB2ZXJzaW9uPSJDaGVtQXhvbiBmaWxlIGZvcm1hdCB2MTYuMDIuMTUsIGdlbmVyYXRlZCBieSB2MTYuMi4yOS4wIj4KPE1Eb2N1bWVudD48TUNoZW1pY2FsU3RydWN0Pjxtb2xlY3VsZSBtb2xJRD0ibTEiPjxhdG9tQXJyYXkgYXRvbUlEPSJhMSBhMiBhMyBhNCBhNSBhNiBhNyBhOCBhOSBhMTAgYTExIGExMiBhMTMgYTE0IGExNSBhMTYgYTE3IGExOCIgZWxlbWVudFR5cGU9IkNsIEMgQyBDIEMgQyBDIENsIE8gQyBDIEMgQyBDIEMgTiBPIE8iIGZvcm1hbENoYXJnZT0iMCAwIDAgMCAwIDAgMCAwIDAgMCAwIDAgMCAwIDAgMSAwIC0xIiB4Mj0iMi42NjgxNzE4OTcxODcyNDQ2IDIuNjY4MTcxODk3MTg3MjQ0NiA0LjAwMjMxNTgzNjkxMDk5NSA0LjAwMjMxNTgzNjkxMDk5NSAyLjY2ODE3MTg5NzE4NzI0NDYgMS4zMzQxNDM5Mzk3MjM3NTAyIDEuMzM0MTQzOTM5NzIzNzUwMiAwLjAgNS4zMzY0NTk3NzY2MzQ3NDUgNi42ODI1NDk4ODkxNjQ4NTQ1IDguMDE2NjkzODI4ODg4NjA0IDkuMzUwNzIxNzg2MzUyMSA5LjM1MDcyMTc4NjM1MjEgOC4wMTY2OTM4Mjg4ODg2MDQgNi42ODI1NDk4ODkxNjQ4NTQ1IDEwLjY4NDg2NTcyNjA3NTg0OSAxMC42ODQ4NjU3MjYwNzU4NDkgMTIuMDE4ODkzNjgzNTM5MzQzIiB5Mj0iMC4wIC0xLjUzODM4ODcwMDAzNDQxMDMgLTIuMzA3NTgzMDUwMDUxNjE1NSAtMy44NTgwMzM5MDUxNTI2NDA3IC00LjYyNzM0NDIzNzQzMDEwMiAtMy44NTgwMzM5MDUxNTI2NDA3IC0yLjMwNzU4MzA1MDA1MTYxNTUgLTQuNjI3MzQ0MjM3NDMwMTAyIC0xLjUzODM4ODcwMDAzNDQxMDMgLTIuMzA3NTgzMDUwMDUxNjE1NSAtMS41MzgzODg3MDAwMzQ0MTAzIC0yLjMwNzU4MzA1MDA1MTYxNTUgLTMuODU4MDMzOTA1MTUyNjQwNyAtNC42MjczNDQyMzc0MzAxMDIgLTMuODU4MDMzOTA1MTUyNjQwNyAtNC42MjczNDQyMzc0MzAxMDIgLTYuMTY1NzMyOTM3NDY0NTEyIC0zLjg1ODAzMzkwNTE1MjY0MDciLz48Ym9uZEFycmF5Pjxib25kIGlkPSJiMSIgYXRvbVJlZnMyPSJhMSBhMiIgb3JkZXI9IjEiLz48Ym9uZCBpZD0iYjIiIGF0b21SZWZzMj0iYTIgYTMiIG9yZGVyPSIyIi8+PGJvbmQgaWQ9ImIzIiBhdG9tUmVmczI9ImEyIGE3IiBvcmRlcj0iMSIvPjxib25kIGlkPSJiNCIgYXRvbVJlZnMyPSJhMyBhNCIgb3JkZXI9IjEiLz48Ym9uZCBpZD0iYjUiIGF0b21SZWZzMj0iYTMgYTkiIG9yZGVyPSIxIi8+PGJvbmQgaWQ9ImI2IiBhdG9tUmVmczI9ImE0IGE1IiBvcmRlcj0iMiIvPjxib25kIGlkPSJiNyIgYXRvbVJlZnMyPSJh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",  # noqa
        "status": "success",
    }
