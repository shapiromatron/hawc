{% extends 'crumbless.html' %}
{% load bs4 %}

{% block content %}
<div class="row m-auto">
  <h2>Welcome, {{ user.get_full_name }}.</h2>
  <div class="dropdown ml-auto">
    <button class="btn btn-primary dropdown-toggle" type="button" id="dropdownMenuButton" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">Actions</button>
    <div class="dropdown-menu dropdown-menu-right" aria-labelledby="dropdownMenuButton">
      <span class="dropdown-header">Assessment Editing</span>
      {% if user.can_create_assessments %}
      <a class="dropdown-item" href="{% url 'assessment:new' %}">Create a new assessment</a>
      {% else %}
      <p class="dropdown-item help-block">Assessment creation disabled - please <a href="{% url 'contact' %}">contact us</a> if needed.</p>
      {% endif %}
    </div>
  </div>
</div>
<p class="mb-3">Welcome to the HAWC portal. Here you're able to create new assessments, or work on existing assessments. Each assessment is a single human-health risk assessment. You can view assessments by the role you've been assigned.</p>
{% if object_list %}
<table id="mainTbl" class="table table-sm table-striped">
  {% bs4_colgroup '50,10,20,20' %}
  {% bs4_thead 'Name,Year,Role,Published Status' %}
  <tbody>
    {% for object in object_list %}
    <tr>
      <td>
        <p class='mb-0'><a href="{{object.get_absolute_url}}">{{object.name}}</a></p>
        {% if object.assessment_objective %}
        <p class='text-muted'>{{object.assessment_objective|striptags|truncatewords:30}}</p>
        {% endif %}
      </td>
      <td>{{object.year}}</td>
      <td>{{object.role_cached}}</td>
      <td>{{object.public_status}}</td>
    </tr>
    {% endfor %}
  </tbody>
</table>
{% else %}
{% alert info %}No assessments available.{% endalert %}
{% endif %}
{% endblock content %}

{% block extrajs %}
{% include "includes/hero_access.html" %}
<script type="text/javascript">
  $(document).ready(function(){
    window.app.HAWCUtils.tablesort(document.getElementById('mainTbl'));
  });
</script>
{% endblock extrajs %}
