import re

import pandas as pd


def parse_request_logs(logs: str) -> pd.DataFrame:
    """Parse logs generated by `hawc.apps.common.middleware.RequestLogMiddleware`.

    Args:
        logs (str): A string of logs

    Returns:
        pd.DataFrame: A pandas dataframe
    """
    regex = re.compile(r"(\w+) (.*) (\d+) (\d+) ip-(.*) user-(\d+) assess-(\d+)")
    data = [list(*regex.findall(line)) for line in logs.strip().splitlines()]
    columns = "verb path status_code content_length ip user_id assessment_id".split(" ")
    df = pd.DataFrame(data=data, columns=columns).apply(pd.to_numeric, errors="ignore")
    return df
